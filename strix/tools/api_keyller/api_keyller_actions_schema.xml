<tools>
  <tool name="check_api_key">
    <description>Check if an API key is alive (valid) or dead (revoked/invalid).

Supports 17+ providers: OpenAI, Anthropic, Google AI (Gemini), Cohere, Mistral, Groq,
DeepSeek, Fireworks AI, Together AI, Perplexity, xAI (Grok), Replicate, Stability AI,
HuggingFace, Stripe, GitHub, and AWS.

Use this tool during security assessments to:
- Validate discovered API keys from reconnaissance
- Check if leaked credentials are still active
- Verify compromised keys found in source code, configs, or environment variables
- Assess the blast radius of exposed secrets</description>
    <details>The tool auto-detects the provider from the key prefix pattern and calls the provider's
API to verify if the key is currently active. Keys are masked in output for safe reporting.
Rate-limited keys are reported as ALIVE. AWS keys (AKIA...) are detected but cannot be
validated without the corresponding secret key.</details>
    <parameters>
      <parameter name="api_key" type="string" required="true">
        <description>The API key to check. The provider will be auto-detected from the key format.
Supported prefixes include: sk-proj- (OpenAI), sk-ant- (Anthropic), AIzaSy (Google),
gsk_ (Groq), hf_ (HuggingFace), ghp_ (GitHub), sk_live_ (Stripe), AKIA (AWS), and more.</description>
      </parameter>
    </parameters>
    <returns type="Dict[str, Any]">
      <description>Response containing: success (bool), key_masked (str), provider (str),
status (ALIVE/DEAD/UNKNOWN), alive (bool/None), detail (str), message (str)</description>
    </returns>
    <examples>
  # Check an Anthropic key found in a .env file
  <function=check_api_key>
  <parameter=api_key>sk-ant-api03-aBcDeFgHiJkLmNoPqRsTuVwXyZ...</parameter>
  </function>

  # Check a Stripe live key found in server config
  <function=check_api_key>
  <parameter=api_key>sk_live_51JGkPaB2eZvKYlo2C...</parameter>
  </function>

  # Check a GitHub PAT found in CI/CD logs
  <function=check_api_key>
  <parameter=api_key>ghp_aBcDeFgHiJkLmNoPqRsTuVwXyZ123456...</parameter>
  </function>

  # Check an OpenAI key found in client-side JavaScript
  <function=check_api_key>
  <parameter=api_key>sk-proj-aBcDeFgHiJkLmNoPqRsTuVwXyZ...</parameter>
  </function>
    </examples>
  </tool>

  <tool name="scan_api_keys">
    <description>Extract and validate all API keys found in a block of text.

Scans text for 19+ key patterns across all supported providers and validates each
discovered key against its provider API.

Use this tool to:
- Scan source code files for leaked secrets
- Analyze configuration files for exposed credentials
- Process text output from reconnaissance tools
- Check clipboard contents or log files for API keys
- Audit environment variable dumps</description>
    <details>Uses regex patterns to extract potential API keys from arbitrary text, then
validates each found key against the corresponding provider API. Returns a detailed
report with masked keys, detected types, alive/dead status, and aggregate counts.</details>
    <parameters>
      <parameter name="text" type="string" required="true">
        <description>The text to scan for API keys. Can be source code, config files,
log output, environment variable dumps, or any text that may contain leaked keys.</description>
      </parameter>
    </parameters>
    <returns type="Dict[str, Any]">
      <description>Response containing: success (bool), keys_found (int), alive_count (int),
dead_count (int), results (list of key check results), message (str)</description>
    </returns>
    <examples>
  # Scan a .env file content for leaked keys
  <function=scan_api_keys>
  <parameter=text>OPENAI_API_KEY=sk-proj-abc123...
ANTHROPIC_API_KEY=sk-ant-api03-xyz789...
STRIPE_SECRET=sk_live_51JGkPa...</parameter>
  </function>

  # Scan source code for hardcoded keys
  <function=scan_api_keys>
  <parameter=text>const client = new OpenAI({ apiKey: "sk-proj-aBcDeFg..." });
headers = {"Authorization": f"Bearer ghp_1234567890abcdef..."}</parameter>
  </function>
    </examples>
  </tool>
</tools>
